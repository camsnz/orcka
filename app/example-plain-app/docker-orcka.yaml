project:
  name: orcka-demo
  context: .
  bake:
    - docker-bake.hcl
  compose:
    - docker-compose.yml
  write: docker-orcka.tags.hcl
    # dir: tmp
    # tags: docker-orcka.tags.hcl
    # compose: 
    # bake: 
  buildtime:
    apply_compose_tags: true
  runtime:
    background: true # use daemon

targets:
  audit-engine:
    calculate_on:
      files:
        - java-gradle-api/build.gradle.kts
        - java-gradle-api/settings.gradle.kts
        - java-gradle-api/src/main/java

  invoice-api:
    calculate_on:
      period:
        unit: weeks
        number: 2
      files:
        - python-fast-api/requirements.txt
        - python-fast-api/app

  ledger-portal:
    calculate_on:
      files:
        - typescript-react-web/package.json
        - typescript-react-web/pnpm-lock.yaml
        - typescript-react-web/src
      jq:
        filename: typescript-react-web/package.json
        selector: '.dependencies,.devDependencies'
